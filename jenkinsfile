pipeline {

  agent {
    node {
        label 'aws-jenkins-slave'
    }
  }
  
  options {
	buildDiscarder(logRotator(numToKeepStr: '2', artifactNumToKeepStr: '2'))
	timestamps()
  }
  
  stages {
    stage('Test') {
      steps {
	sh 'gradle clean build'
      }
    }
    stage('Report') {
      steps {
          echo '---------------'
     }
    }
  }

  post {
    always {
    	sh '$JENKINS_HOME'
    	sh 'pwd'
       	sh 'cd build/reports/tests/test/'
	sh 'pwd'
	sh 'scp -r * ubuntu@172.31.44.190:/var/www/testgradle_report/'
    }
  }
  
}

